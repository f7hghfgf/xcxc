name: Scheduled Headless Browser Visit

on:
  schedule:
    - cron: '0 */11 * * *'  # æ¯ 3 å°æ—¶çš„æ•´ç‚¹è¿è¡Œä¸€æ¬¡ï¼ˆUTCï¼‰
  workflow_dispatch:      # ğŸ‘ˆ æ·»åŠ è¿™ä¸ªä»¥æ”¯æŒæ‰‹åŠ¨è§¦å‘

jobs:
  visit-and-click:
    runs-on: ubuntu-latest
    env:
      TARGET_URLS: ${{ secrets.TARGET_URLS }}
      COOKIE_MAP: ${{ secrets.COOKIE_MAP }}
      USER_AGENT: ${{ secrets.USER_AGENT }}
      IMGE_API_KEY: ${{ secrets.IMGE_API_KEY }}
      IMGE_ALBUM_ID: ${{ secrets.IMGE_ALBUM_ID }}
    steps:
      - name: Checkout repo
        uses: actions/checkout@v3

      - name: Setup Node.js
        uses: actions/setup-node@v3
        with:
        
          node-version: '18'

      - name: Install dependencies      
        run: npm ci
      - name: Run Puppeteer script
        run: node visit.js
      # - name: Upload package-lock.json
      #   uses: actions/upload-artifact@v4
      #   with:
      #     name: package-lock
      #     path: package-lock.json
